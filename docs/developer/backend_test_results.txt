============================= test session starts ==============================
platform linux -- Python 3.12.3, pytest-8.2.2, pluggy-1.6.0 -- /home/marcin/Dokumenty/agentai/makeit/AIASISSTMARUBO/.venv/bin/python3.12
cachedir: .pytest_cache
rootdir: /home/marcin/Dokumenty/agentai/makeit/AIASISSTMARUBO
configfile: pytest.ini
plugins: asyncio-0.23.7, anyio-4.9.0, cov-5.0.0
asyncio: mode=Mode.STRICT
collecting ... collected 1080 items

docs/archive/test_fixes_simple.py::test_fixes PASSED                     [  0%]
docs/archive/test_knowledge_verification.py::test_knowledge_verification PASSED [  0%]
scripts/test_api_simple.py::test_api PASSED                              [  0%]
scripts/test_rag_system.py::test_document_processing PASSED              [  0%]
scripts/test_rag_system.py::test_database_sync PASSED                    [  0%]
scripts/test_rag_system.py::test_search_functionality PASSED             [  0%]
scripts/test_rag_system.py::test_vector_store_stats PASSED               [  0%]
scripts/test_rag_system.py::test_file_processing PASSED                  [  0%]
src/backend/tests/integration/test_search_integration.py::test_search_integration_wikipedia_encyclopedic PASSED [  0%]
src/backend/tests/integration/test_search_integration.py::test_search_integration_duckduckgo_web PASSED [  0%]
src/backend/tests/integration/test_search_integration.py::test_search_integration_fallback_scenario PASSED [  1%]
src/backend/tests/integration/test_search_integration.py::test_search_integration_error_recovery PASSED [  1%]
src/backend/tests/integration/test_search_integration.py::test_search_integration_prefix_override PASSED [  1%]
src/backend/tests/integration/test_search_integration.py::test_search_integration_real_world_scenarios PASSED [  1%]
src/backend/tests/performance/test_db_performance.py::test_conversation_query_performance SKIPPED [  1%]
src/backend/tests/performance/test_db_performance.py::test_shopping_query_performance SKIPPED [  1%]
src/backend/tests/performance/test_db_performance.py::test_memory_usage SKIPPED [  1%]
src/backend/tests/performance/test_memory_profiling.py::TestMemoryProfiler::test_memory_profiler_initialization SKIPPED [  1%]
src/backend/tests/performance/test_memory_profiling.py::TestMemoryProfiler::test_take_snapshot SKIPPED [  1%]
src/backend/tests/performance/test_memory_profiling.py::TestMemoryProfiler::test_get_performance_metrics SKIPPED [  1%]
src/backend/tests/performance/test_memory_profiling.py::TestMemoryProfiler::test_memory_leak_detection SKIPPED [  1%]
src/backend/tests/performance/test_memory_profiling.py::TestMemoryProfiler::test_cleanup SKIPPED [  2%]
src/backend/tests/performance/test_memory_profiling.py::TestAsyncMemoryProfiler::test_async_snapshot SKIPPED [  2%]
src/backend/tests/performance/test_memory_profiling.py::TestAsyncMemoryProfiler::test_async_performance_metrics SKIPPED [  2%]
src/backend/tests/performance/test_memory_profiling.py::TestMemoryProfilingContext::test_memory_profiling_context SKIPPED [  2%]
src/backend/tests/performance/test_memory_profiling.py::TestMemoryProfilingContext::test_async_memory_profiling_context SKIPPED [  2%]
src/backend/tests/performance/test_memory_profiling.py::TestMemoryMonitor::test_get_profiler SKIPPED [  2%]
src/backend/tests/performance/test_memory_profiling.py::TestMemoryMonitor::test_cleanup_all SKIPPED [  2%]
src/backend/tests/performance/test_memory_profiling.py::TestMemoryProfilingBenchmarks::test_snapshot_creation_benchmark SKIPPED [  2%]
src/backend/tests/performance/test_memory_profiling.py::TestMemoryProfilingBenchmarks::test_performance_metrics_benchmark SKIPPED [  2%]
src/backend/tests/performance/test_memory_profiling.py::TestMemoryProfilingBenchmarks::test_async_snapshot_benchmark SKIPPED [  2%]
src/backend/tests/performance/test_memory_profiling.py::TestMemoryLeakDetection::test_no_memory_leak SKIPPED [  2%]
src/backend/tests/performance/test_memory_profiling.py::TestMemoryLeakDetection::test_memory_leak_threshold SKIPPED [  3%]
src/backend/tests/performance/test_memory_profiling.py::TestMemoryProfilingIntegration::test_full_profiling_cycle PASSED [  3%]
src/backend/tests/performance/test_memory_profiling.py::TestMemoryProfilingIntegration::test_async_profiling_cycle PASSED [  3%]
src/backend/tests/test_agent_factory_new.py::TestAgentFactoryNew::test_agent_factory_initialization PASSED [  3%]
src/backend/tests/test_agent_factory_new.py::TestAgentFactoryNew::test_agent_registry_contains_expected_agents PASSED [  3%]
src/backend/tests/test_agent_factory_new.py::TestAgentFactoryNew::test_create_general_conversation_agent PASSED [  3%]
src/backend/tests/test_agent_factory_new.py::TestAgentFactoryNew::test_create_chef_agent PASSED [  3%]
src/backend/tests/test_agent_factory_new.py::TestAgentFactoryNew::test_create_search_agent PASSED [  3%]
src/backend/tests/test_agent_factory_new.py::TestAgentFactoryNew::test_create_weather_agent PASSED [  3%]
src/backend/tests/test_agent_factory_new.py::TestAgentFactoryNew::test_create_rag_agent PASSED [  3%]
src/backend/tests/test_agent_factory_new.py::TestAgentFactoryNew::test_create_ocr_agent PASSED [  3%]
src/backend/tests/test_agent_factory_new.py::TestAgentFactoryNew::test_create_categorization_agent PASSED [  4%]
src/backend/tests/test_agent_factory_new.py::TestAgentFactoryNew::test_create_meal_planner_agent PASSED [  4%]
src/backend/tests/test_agent_factory_new.py::TestAgentFactoryNew::test_create_analytics_agent PASSED [  4%]
src/backend/tests/test_agent_factory_new.py::TestAgentFactoryNew::test_create_promo_scraping_agent PASSED [  4%]
src/backend/tests/test_agent_factory_new.py::TestAgentFactoryNew::test_create_agent_with_alias PASSED [  4%]
src/backend/tests/test_agent_factory_new.py::TestAgentFactoryNew::test_create_agent_with_fallback PASSED [  4%]
src/backend/tests/test_agent_factory_new.py::TestAgentFactoryNew::test_create_agent_with_config PASSED [  4%]
src/backend/tests/test_agent_factory_new.py::TestAgentFactoryNew::test_create_agent_with_kwargs PASSED [  4%]
src/backend/tests/test_agent_factory_new.py::TestAgentFactoryNew::test_agent_caching PASSED [  4%]
src/backend/tests/test_agent_factory_new.py::TestAgentFactoryNew::test_agent_no_caching PASSED [  4%]
src/backend/tests/test_agent_factory_new.py::TestAgentFactoryNew::test_agent_registry_integration PASSED [  5%]
src/backend/tests/test_agent_factory_new.py::TestAgentFactoryNew::test_get_available_agents PASSED [  5%]
src/backend/tests/test_agent_factory_new.py::TestAgentFactoryNew::test_cleanup PASSED [  5%]
src/backend/tests/test_agent_factory_new.py::TestAgentFactoryNew::test_reset PASSED [  5%]
src/backend/tests/test_agent_factory_new.py::TestAgentFactoryNew::test_thread_safety PASSED [  5%]
src/backend/tests/test_agent_factory_new.py::TestAgentFactoryNew::test_agent_config_model PASSED [  5%]
src/backend/tests/test_agent_factory_new.py::TestAgentFactoryNew::test_error_handling PASSED [  5%]
src/backend/tests/test_agent_factory_new.py::TestAgentFactoryNew::test_agent_factory_with_container PASSED [  5%]
src/backend/tests/test_agent_prompts.py::test_agent_prompt_routing[Podaj przepis na szybki obiad z kurczakiem i ry\u017cem.-chef] PASSED [  5%]
src/backend/tests/test_agent_prompts.py::test_agent_prompt_routing[Zaproponuj wega\u0144skie \u015bniadanie na jutro.-chef] PASSED [  5%]
src/backend/tests/test_agent_prompts.py::test_agent_prompt_routing[Jaka b\u0119dzie pogoda w Warszawie jutro?-weather] PASSED [  5%]
src/backend/tests/test_agent_prompts.py::test_agent_prompt_routing[Czy dzi\u015b b\u0119dzie pada\u0107 w Krakowie?-weather] PASSED [  6%]
src/backend/tests/test_agent_prompts.py::test_agent_prompt_routing[Ile kalorii ma awokado?-search] PASSED [  6%]
src/backend/tests/test_agent_prompts.py::test_agent_prompt_routing[Jakie s\u0105 zalety diety \u015br\xf3dziemnomorskiej?-search] PASSED [  6%]
src/backend/tests/test_agent_prompts.py::test_agent_prompt_routing[Przetw\xf3rz za\u0142\u0105czony paragon i wypisz produkty.-ocr] PASSED [  6%]
src/backend/tests/test_agent_prompts.py::test_agent_prompt_routing[Odczytaj tekst z za\u0142\u0105czonego zdj\u0119cia.-ocr] PASSED [  6%]
src/backend/tests/test_agent_prompts.py::test_agent_prompt_routing[Jak przechowywa\u0107 \u015bwie\u017ce zio\u0142a wed\u0142ug dokumentacji FoodSave?-rag] PASSED [  6%]
src/backend/tests/test_agent_prompts.py::test_agent_prompt_routing[Podsumuj najwa\u017cniejsze zasady ograniczania marnowania \u017cywno\u015bci.-rag] PASSED [  6%]
src/backend/tests/test_chef_agent.py::test_chef_agent_streaming PASSED   [  6%]
src/backend/tests/test_chef_agent.py::test_chef_agent_error_handling PASSED [  6%]
src/backend/tests/test_chef_agent.py::test_chef_agent_input_validation PASSED [  6%]
src/backend/tests/test_chef_agent.py::test_chef_agent_dietary_restrictions PASSED [  6%]
src/backend/tests/test_chef_agent.py::test_chef_agent_llm_error PASSED   [  7%]
src/backend/tests/test_enhanced_rag_agent.py::TestRAGAgent::test_agent_initialization PASSED [  7%]
src/backend/tests/test_enhanced_rag_agent.py::TestRAGAgent::test_add_document PASSED [  7%]
src/backend/tests/test_enhanced_rag_agent.py::TestRAGAgent::test_search PASSED [  7%]
src/backend/tests/test_enhanced_rag_agent.py::TestRAGAgent::test_process_query PASSED [  7%]
src/backend/tests/test_enhanced_rag_agent.py::TestRAGAgent::test_process_document PASSED [  7%]
src/backend/tests/test_enhanced_rag_agent.py::TestRAGAgent::test_process_empty_query PASSED [  7%]
src/backend/tests/test_general_conversation_agent.py::TestGeneralConversationAgent::test_process_with_valid_input PASSED [  7%]
src/backend/tests/test_general_conversation_agent.py::TestGeneralConversationAgent::test_process_with_empty_query PASSED [  7%]
src/backend/tests/test_general_conversation_agent.py::TestGeneralConversationAgent::test_get_rag_context_success PASSED [  7%]
src/backend/tests/test_general_conversation_agent.py::TestGeneralConversationAgent::test_get_rag_context_empty PASSED [  7%]
src/backend/tests/test_general_conversation_agent.py::TestGeneralConversationAgent::test_get_rag_context_with_documents PASSED [  8%]
src/backend/tests/test_general_conversation_agent.py::TestGeneralConversationAgent::test_get_internet_context_with_perplexity PASSED [  8%]
src/backend/tests/test_general_conversation_agent.py::TestGeneralConversationAgent::test_get_internet_context_with_local_search PASSED [  8%]
src/backend/tests/test_general_conversation_agent.py::TestGeneralConversationAgent::test_generate_response_with_bielik PASSED [  8%]
src/backend/tests/test_general_conversation_agent.py::TestGeneralConversationAgent::test_generate_response_with_gemma PASSED [  8%]
src/backend/tests/test_general_conversation_agent.py::TestGeneralConversationAgent::test_generate_response_error_handling PASSED [  8%]
src/backend/tests/test_general_conversation_agent.py::TestGeneralConversationAgent::test_process_exception_handling PASSED [  8%]
src/backend/tests/test_general_conversation_agent.py::TestGeneralConversationAgent::test_get_internet_context_empty PASSED [  8%]
src/backend/tests/test_general_conversation_agent.py::TestGeneralConversationAgent::test_get_internet_context_with_results PASSED [  8%]
src/backend/tests/test_general_conversation_agent.py::TestGeneralConversationAgent::test_process_date_query PASSED [  8%]
src/backend/tests/test_hybrid_llm_client_new.py::TestHybridLLMClientNew::test_chat_with_bielik_default PASSED [  8%]
src/backend/tests/test_hybrid_llm_client_new.py::TestHybridLLMClientNew::test_chat_with_bielik_explicit PASSED [  9%]
src/backend/tests/test_hybrid_llm_client_new.py::TestHybridLLMClientNew::test_chat_with_gemma PASSED [  9%]
src/backend/tests/test_hybrid_llm_client_new.py::TestHybridLLMClientNew::test_chat_with_perplexity PASSED [  9%]
src/backend/tests/test_hybrid_llm_client_new.py::TestHybridLLMClientNew::test_chat_with_bielik_fallback_on_error PASSED [  9%]
src/backend/tests/test_hybrid_llm_client_new.py::TestHybridLLMClientNew::test_chat_with_gemma_fallback_on_error PASSED [  9%]
src/backend/tests/test_hybrid_llm_client_new.py::TestHybridLLMClientNew::test_chat_with_all_models_failing PASSED [  9%]
src/backend/tests/test_hybrid_llm_client_new.py::TestHybridLLMClientNew::test_chat_with_perplexity_fallback PASSED [  9%]
src/backend/tests/test_hybrid_llm_client_new.py::TestHybridLLMClientNew::test_chat_with_custom_parameters PASSED [  9%]
src/backend/tests/test_hybrid_llm_client_new.py::TestHybridLLMClientNew::test_chat_with_streaming PASSED [  9%]
src/backend/tests/test_hybrid_llm_client_new.py::TestHybridLLMClientNew::test_chat_with_system_message PASSED [  9%]
src/backend/tests/test_hybrid_llm_client_new.py::TestHybridLLMClientNew::test_chat_with_empty_messages PASSED [ 10%]
src/backend/tests/test_hybrid_llm_client_new.py::TestHybridLLMClientNew::test_chat_with_invalid_message_format PASSED [ 10%]
src/backend/tests/test_hybrid_llm_client_new.py::TestHybridLLMClientNew::test_get_available_models PASSED [ 10%]
src/backend/tests/test_hybrid_llm_client_new.py::TestHybridLLMClientNew::test_get_model_info PASSED [ 10%]
src/backend/tests/test_hybrid_llm_client_new.py::TestHybridLLMClientNew::test_get_model_info_unknown_model PASSED [ 10%]
src/backend/tests/test_hybrid_llm_client_new.py::TestHybridLLMClientNew::test_client_initialization PASSED [ 10%]
src/backend/tests/test_integration_agents.py::test_integration_chat_flow PASSED [ 10%]
src/backend/tests/test_integration_agents.py::test_integration_error_handling PASSED [ 10%]
src/backend/tests/test_integration_agents.py::test_integration_combined_flow PASSED [ 10%]
src/backend/tests/test_integration_agents.py::test_integration_performance PASSED [ 10%]
src/backend/tests/test_integration_agents.py::test_integration_fallback_mechanism PASSED [ 10%]
src/backend/tests/test_integration_new_features.py::TestIntegrationNewFeatures::test_complete_flow_with_bielik PASSED [ 11%]
src/backend/tests/test_integration_new_features.py::TestIntegrationNewFeatures::test_complete_flow_with_gemma PASSED [ 11%]
src/backend/tests/test_integration_new_features.py::TestIntegrationNewFeatures::test_intent_detection_and_agent_routing PASSED [ 11%]
src/backend/tests/test_integration_new_features.py::TestIntegrationNewFeatures::test_model_fallback_mechanism PASSED [ 11%]
src/backend/tests/test_integration_new_features.py::TestIntegrationNewFeatures::test_general_conversation_agent_with_rag_and_internet PASSED [ 11%]
src/backend/tests/test_integration_new_features.py::TestIntegrationNewFeatures::test_cooking_agent_with_model_selection PASSED [ 11%]
src/backend/tests/test_integration_new_features.py::TestIntegrationNewFeatures::test_search_agent_with_model_selection PASSED [ 11%]
src/backend/tests/test_integration_new_features.py::TestIntegrationNewFeatures::test_weather_agent_with_model_selection PASSED [ 11%]
src/backend/tests/test_integration_new_features.py::TestIntegrationNewFeatures::test_error_handling_integration PASSED [ 11%]
src/backend/tests/test_integration_new_features.py::TestIntegrationNewFeatures::test_concurrent_requests_with_different_models PASSED [ 11%]
src/backend/tests/test_intent_detector_new.py::TestIntentDetectorNew::test_shopping_conversation_detection PASSED [ 11%]
src/backend/tests/test_intent_detector_new.py::TestIntentDetectorNew::test_food_conversation_detection PASSED [ 12%]
src/backend/tests/test_intent_detector_new.py::TestIntentDetectorNew::test_information_query_detection PASSED [ 12%]
src/backend/tests/test_intent_detector_new.py::TestIntentDetectorNew::test_general_conversation_detection PASSED [ 12%]
src/backend/tests/test_intent_detector_new.py::TestIntentDetectorNew::test_weather_intent_detection PASSED [ 12%]
src/backend/tests/test_intent_detector_new.py::TestIntentDetectorNew::test_cooking_intent_detection PASSED [ 12%]
src/backend/tests/test_intent_detector_new.py::TestIntentDetectorNew::test_search_intent_detection PASSED [ 12%]
src/backend/tests/test_intent_detector_new.py::TestIntentDetectorNew::test_ocr_intent_detection PASSED [ 12%]
src/backend/tests/test_intent_detector_new.py::TestIntentDetectorNew::test_fallback_to_general_conversation PASSED [ 12%]
src/backend/tests/test_intent_detector_new.py::TestIntentDetectorNew::test_llm_response_parsing PASSED [ 12%]
src/backend/tests/test_intent_detector_new.py::TestIntentDetectorNew::test_error_handling PASSED [ 12%]
src/backend/tests/test_meal_planner_agent.py::test_meal_planner_with_products PASSED [ 12%]
src/backend/tests/test_meal_planner_agent.py::test_meal_planner_no_products PASSED [ 13%]
src/backend/tests/test_ocr_agent.py::test_ocr_agent_success_image PASSED [ 13%]
src/backend/tests/test_ocr_agent.py::test_ocr_agent_success_pdf PASSED   [ 13%]
src/backend/tests/test_ocr_agent.py::test_ocr_agent_input_validation PASSED [ 13%]
src/backend/tests/test_ocr_agent.py::test_ocr_agent_unsupported_file_type PASSED [ 13%]
src/backend/tests/test_ocr_agent.py::test_ocr_agent_empty_result PASSED  [ 13%]
src/backend/tests/test_ocr_agent.py::test_ocr_agent_processing_error PASSED [ 13%]
src/backend/tests/test_optimized_conversation_agent.py::test_parallel_processing PASSED [ 13%]
src/backend/tests/test_optimized_conversation_agent.py::test_caching PASSED [ 13%]
src/backend/tests/test_optimized_conversation_agent.py::test_adaptive_model_selection PASSED [ 13%]
src/backend/tests/test_weather_agent.py::test_weather_agent_success PASSED [ 13%]
src/backend/tests/test_weather_agent.py::test_weather_agent_no_api_key PASSED [ 14%]
src/backend/tests/test_weather_agent.py::test_weather_agent_input_validation PASSED [ 14%]
src/backend/tests/test_weather_agent.py::test_weather_agent_error_handling PASSED [ 14%]
src/backend/tests/test_weather_agent.py::test_weather_request_model PASSED [ 14%]
src/backend/tests/unit/test_alert_service.py::TestAlertService::test_should_alert_below_threshold PASSED [ 14%]
src/backend/tests/unit/test_alert_service.py::TestAlertService::test_should_alert_above_threshold PASSED [ 14%]
src/backend/tests/unit/test_alert_service.py::TestAlertService::test_should_alert_throttling PASSED [ 14%]
src/backend/tests/unit/test_alert_service.py::TestAlertService::test_send_alert PASSED [ 14%]
src/backend/tests/unit/test_alert_service.py::TestAlertService::test_send_alert_not_triggered PASSED [ 14%]
src/backend/tests/unit/test_alerting.py::TestAlerting::test_alert_manager_initialization PASSED [ 14%]
src/backend/tests/unit/test_alerting.py::TestAlerting::test_add_remove_rule PASSED [ 15%]
src/backend/tests/unit/test_alerting.py::TestAlerting::test_record_metric PASSED [ 15%]
src/backend/tests/unit/test_alerting.py::TestAlerting::test_metric_value_cleanup PASSED [ 15%]
src/backend/tests/unit/test_alerting.py::TestAlerting::test_evaluate_rule_threshold_exceeded PASSED [ 15%]
src/backend/tests/unit/test_alerting.py::TestAlerting::test_evaluate_rule_threshold_not_exceeded PASSED [ 15%]
src/backend/tests/unit/test_alerting.py::TestAlerting::test_evaluate_rule_with_duration_window PASSED [ 15%]
src/backend/tests/unit/test_alerting.py::TestAlerting::test_check_alerts PASSED [ 15%]
src/backend/tests/unit/test_alerting.py::TestAlerting::test_acknowledge_alert PASSED [ 15%]
src/backend/tests/unit/test_alerting.py::TestAlerting::test_resolve_alert PASSED [ 15%]
src/backend/tests/unit/test_alerting.py::TestAlerting::test_get_active_alerts PASSED [ 15%]
src/backend/tests/unit/test_alerting.py::TestAlerting::test_get_alert_history PASSED [ 15%]
src/backend/tests/unit/test_alerting.py::TestAlerting::test_get_alert_stats PASSED [ 16%]
src/backend/tests/unit/test_alerting.py::TestAlerting::test_alert_cooldown PASSED [ 16%]
src/backend/tests/unit/test_alerting.py::TestAlerting::test_record_system_metrics PASSED [ 16%]
src/backend/tests/unit/test_alerting.py::TestAlerting::test_alert_rule_operators PASSED [ 16%]
src/backend/tests/unit/test_circuit_breaker.py::TestCircuitBreaker::test_closed_state_success PASSED [ 16%]
src/backend/tests/unit/test_circuit_breaker.py::TestCircuitBreaker::test_closed_to_open_transition PASSED [ 16%]
src/backend/tests/unit/test_circuit_breaker.py::TestCircuitBreaker::test_open_state_blocks_calls PASSED [ 16%]
src/backend/tests/unit/test_circuit_breaker.py::TestCircuitBreaker::test_open_to_half_open_transition PASSED [ 16%]
src/backend/tests/unit/test_circuit_breaker.py::TestCircuitBreaker::test_half_open_to_closed PASSED [ 16%]
src/backend/tests/unit/test_circuit_breaker.py::TestCircuitBreaker::test_half_open_to_open PASSED [ 16%]
src/backend/tests/unit/test_circuit_breaker.py::TestCircuitBreakerDecorator::test_decorator_success PASSED [ 16%]
src/backend/tests/unit/test_circuit_breaker.py::TestCircuitBreakerDecorator::test_decorator_failure PASSED [ 17%]
src/backend/tests/unit/test_error_handler.py::TestErrorHandler::test_execute_with_fallback_success PASSED [ 17%]
src/backend/tests/unit/test_error_handler.py::TestErrorHandler::test_execute_with_fallback_error PASSED [ 17%]
src/backend/tests/unit/test_error_handler.py::TestErrorHandler::test_execute_with_fallback_fallback_success PASSED [ 17%]
src/backend/tests/unit/test_error_handler.py::TestErrorHandler::test_should_alert_below_threshold PASSED [ 17%]
src/backend/tests/unit/test_error_handler.py::TestErrorHandler::test_should_alert_above_threshold PASSED [ 17%]
src/backend/tests/unit/test_error_handler.py::TestErrorHandler::test_should_alert_throttling PASSED [ 17%]
src/backend/tests/unit/test_error_handler.py::TestErrorHandler::test_send_alert PASSED [ 17%]
src/backend/tests/unit/test_fallback_manager.py::TestFallbackStrategies::test_prompt_rewriting_strategy PASSED [ 17%]
src/backend/tests/unit/test_fallback_manager.py::TestFallbackStrategies::test_simplified_model_strategy PASSED [ 17%]
src/backend/tests/unit/test_fallback_manager.py::TestFallbackStrategies::test_minimal_response_strategy PASSED [ 17%]
src/backend/tests/unit/test_fallback_manager.py::TestFallbackManager::test_execute_fallback PASSED [ 18%]
src/backend/tests/unit/test_fallback_manager.py::TestFallbackManager::test_execute_fallback_all_fail PASSED [ 18%]
src/backend/tests/unit/test_memory_context.py::test_set_last_command PASSED [ 18%]
src/backend/tests/unit/test_memory_monitoring_middleware.py::TestMemoryMonitoringMiddleware::test_middleware_initialization PASSED [ 18%]
src/backend/tests/unit/test_memory_monitoring_middleware.py::TestMemoryMonitoringMiddleware::test_middleware_with_memory_profiling_disabled PASSED [ 18%]
src/backend/tests/unit/test_memory_monitoring_middleware.py::TestMemoryMonitoringMiddleware::test_middleware_with_memory_profiling_enabled PASSED [ 18%]
src/backend/tests/unit/test_memory_monitoring_middleware.py::TestMemoryMonitoringMiddleware::test_middleware_logs_memory_usage SKIPPED [ 18%]
src/backend/tests/unit/test_memory_monitoring_middleware.py::TestMemoryMonitoringMiddleware::test_middleware_handles_exceptions PASSED [ 18%]
src/backend/tests/unit/test_memory_monitoring_middleware.py::TestMemoryMonitoringMiddleware::test_middleware_different_endpoints SKIPPED [ 18%]
src/backend/tests/unit/test_memory_monitoring_middleware.py::TestMemoryMonitoringMiddleware::test_middleware_context_names SKIPPED [ 18%]
src/backend/tests/unit/test_memory_monitoring_middleware.py::TestMemoryMonitoringMiddleware::test_middleware_performance_impact SKIPPED [ 18%]
src/backend/tests/unit/test_memory_monitoring_middleware.py::TestMemoryMonitoringMiddlewareIntegration::test_middleware_with_real_memory_usage SKIPPED [ 19%]
src/backend/tests/unit/test_memory_monitoring_middleware.py::TestMemoryMonitoringMiddlewareIntegration::test_middleware_concurrent_requests SKIPPED [ 19%]
src/backend/tests/unit/test_model_fallback_manager.py::test_model_fallback_and_recovery PASSED [ 19%]
src/backend/tests/unit/test_model_fallback_manager.py::test_model_health_check PASSED [ 19%]
src/backend/tests/unit/test_model_fallback_manager.py::test_model_fallback_disabled PASSED [ 19%]
src/backend/tests/unit/test_plugin_manager.py::test_register_plugin PASSED [ 19%]
src/backend/tests/unit/test_plugin_manager.py::test_duplicate_registration PASSED [ 19%]
src/backend/tests/unit/test_plugin_manager.py::test_unregister_plugin PASSED [ 19%]
src/backend/tests/unit/test_plugin_manager.py::test_initialize_plugins PASSED [ 19%]
src/backend/tests/unit/test_plugin_manager.py::test_before_processing PASSED [ 19%]
src/backend/tests/unit/test_plugin_manager.py::test_after_processing PASSED [ 20%]
src/backend/tests/unit/test_plugin_manager.py::test_get_plugin PASSED    [ 20%]
src/backend/tests/unit/test_prometheus_metrics.py::TestPrometheusMetrics::test_record_agent_metrics PASSED [ 20%]
src/backend/tests/unit/test_prometheus_metrics.py::TestPrometheusMetrics::test_record_db_metrics PASSED [ 20%]
src/backend/tests/unit/test_prometheus_metrics.py::TestPrometheusMetrics::test_record_llm_metrics PASSED [ 20%]
src/backend/tests/unit/test_prometheus_metrics.py::TestPrometheusMetrics::test_record_vector_metrics PASSED [ 20%]
src/backend/tests/unit/test_prometheus_metrics.py::TestPrometheusMetrics::test_record_ocr_metrics PASSED [ 20%]
src/backend/tests/unit/test_prometheus_metrics.py::TestPrometheusMetrics::test_record_cache_metrics PASSED [ 20%]
src/backend/tests/unit/test_prometheus_metrics.py::TestPrometheusMetrics::test_record_circuit_breaker_metrics PASSED [ 20%]
src/backend/tests/unit/test_prometheus_metrics.py::TestPrometheusMetrics::test_get_metrics PASSED [ 20%]
src/backend/tests/unit/test_prometheus_metrics.py::TestPrometheusMetrics::test_get_metrics_dict PASSED [ 20%]
src/backend/tests/unit/test_prometheus_metrics.py::TestPrometheusMetrics::test_metrics_collector PASSED [ 21%]
src/backend/tests/unit/test_prometheus_metrics.py::TestPrometheusMetrics::test_metrics_collector_error_handling PASSED [ 21%]
src/backend/tests/unit/test_prometheus_metrics.py::TestPrometheusMetrics::test_multiple_metric_recordings PASSED [ 21%]
src/backend/tests/unit/test_rate_limiter.py::TestTokenBucket::test_consume_tokens PASSED [ 21%]
src/backend/tests/unit/test_rate_limiter.py::TestTokenBucket::test_refill_tokens PASSED [ 21%]
src/backend/tests/unit/test_rate_limiter.py::TestTokenBucket::test_rate_limit_exceeded PASSED [ 21%]
src/backend/tests/unit/test_rate_limiter.py::TestRateLimiter::test_global_limit PASSED [ 21%]
src/backend/tests/unit/test_rate_limiter.py::TestRateLimiter::test_user_limit PASSED [ 21%]
src/backend/tests/unit/test_rate_limiter.py::TestRateLimiter::test_combined_limits PASSED [ 21%]
src/backend/tests/unit/test_rate_limiter.py::TestRateLimitedDecorator::test_rate_limited_method PASSED [ 21%]
src/backend/tests/unit/test_search_agent.py::test_detect_search_type_prefix PASSED [ 21%]
src/backend/tests/unit/test_search_agent.py::test_detect_search_type_heuristics PASSED [ 22%]
src/backend/tests/unit/test_search_agent.py::test_detect_search_type_default PASSED [ 22%]
src/backend/tests/unit/test_search_agent.py::test_process_request_success PASSED [ 22%]
src/backend/tests/unit/test_search_agent.py::test_process_request_fallback_no_results PASSED [ 22%]
src/backend/tests/unit/test_search_agent.py::test_process_request_fallback_error PASSED [ 22%]
src/backend/tests/unit/test_search_agent.py::test_process_request_both_providers_fail PASSED [ 22%]
src/backend/tests/unit/test_search_agent.py::test_process_request_wikipedia_provider PASSED [ 22%]
src/backend/tests/unit/test_search_agent.py::test_process_request_empty_query PASSED [ 22%]
src/backend/tests/unit/test_search_agent.py::test_process_request_none_context PASSED [ 22%]
src/backend/tests/unit/test_search_agent.py::test_process_method_success PASSED [ 22%]
src/backend/tests/unit/test_search_agent.py::test_process_method_empty_query PASSED [ 22%]
src/backend/tests/unit/test_search_agent.py::test_process_method_with_context PASSED [ 23%]
src/backend/tests/unit/test_search_agent.py::test_format_search_results_wikipedia PASSED [ 23%]
src/backend/tests/unit/test_search_agent.py::test_format_search_results_duckduckgo PASSED [ 23%]
src/backend/tests/unit/test_search_agent.py::test_format_search_results_empty PASSED [ 23%]
src/backend/tests/unit/test_search_agent.py::test_format_search_results_limit PASSED [ 23%]
src/backend/tests/unit/test_search_agent.py::test_get_metadata PASSED    [ 23%]
src/backend/tests/unit/test_search_agent.py::test_get_dependencies PASSED [ 23%]
src/backend/tests/unit/test_search_agent.py::test_is_healthy PASSED      [ 23%]
src/backend/tests/unit/test_search_providers.py::test_wikipedia_search_success PASSED [ 23%]
src/backend/tests/unit/test_search_providers.py::test_wikipedia_search_no_results PASSED [ 23%]
src/backend/tests/unit/test_search_providers.py::test_wikipedia_search_api_error PASSED [ 23%]
src/backend/tests/unit/test_search_providers.py::test_duckduckgo_search_with_abstract PASSED [ 24%]
src/backend/tests/unit/test_search_providers.py::test_duckduckgo_search_no_abstract PASSED [ 24%]
src/backend/tests/unit/test_search_providers.py::test_duckduckgo_search_empty_response PASSED [ 24%]
src/backend/tests/unit/test_search_providers.py::test_duckduckgo_search_api_error PASSED [ 24%]
src/backend/tests/unit/test_search_providers.py::test_wikipedia_search_params PASSED [ 24%]
src/backend/tests/unit/test_search_providers.py::test_duckduckgo_search_params PASSED [ 24%]
src/backend/tests/unit/test_telemetry.py::TestTelemetry::test_setup_telemetry PASSED [ 24%]
src/backend/tests/unit/test_telemetry.py::TestTelemetry::test_create_span PASSED [ 24%]
src/backend/tests/unit/test_telemetry.py::TestTelemetry::test_span_context PASSED [ 24%]
src/backend/tests/unit/test_telemetry.py::TestTelemetry::test_traced_function_decorator PASSED [ 24%]
src/backend/tests/unit/test_telemetry.py::TestTelemetry::test_traced_async_function_decorator PASSED [ 25%]
src/backend/tests/unit/test_telemetry.py::TestTelemetry::test_span_context_with_exception PASSED [ 25%]
src/backend/tests/unit/test_telemetry.py::TestTelemetry::test_get_tracer_singleton PASSED [ 25%]
src/test_db_connection.py::test_database_connection SKIPPED (async d...) [ 25%]
test_anti_hallucination.py::test_chat_endpoint ERROR                     [ 25%]

==================================== ERRORS ====================================
_____________________ ERROR at setup of test_chat_endpoint _____________________
file /home/marcin/Dokumenty/agentai/makeit/AIASISSTMARUBO/test_anti_hallucination.py, line 14
  async def test_chat_endpoint(session, message, session_id="test-anti-hallucination"):
      """Test the chat endpoint with a specific message"""
      url = "http://localhost:8000/api/chat/memory_chat"
      payload = {
          "message": message,
          "session_id": session_id,
          "usePerplexity": False,
          "useBielik": True,
      }

      try:
          async with session.post(url, json=payload) as response:
              if response.status == 200:
                  # For streaming response, we need to read the stream
                  response_text = ""
                  async for line in response.content:
                      if line:
                          try:
                              data = json.loads(line.decode("utf-8"))
                              if "text" in data:
                                  response_text += data["text"]
                          except json.JSONDecodeError:
                              continue
                  return response_text
              return f"Error: {response.status}"
      except Exception as e:
          return f"Exception: {e!s}"
E       fixture 'message' not found
>       available fixtures: _session_event_loop, anyio_backend, anyio_backend_name, anyio_backend_options, async_client, cache, capfd, capfdbinary, caplog, capsys, capsysbinary, cleanup_after_test, client, cov, db_session, doctest_namespace, error_test_cases, event_loop, event_loop_policy, free_tcp_port, free_tcp_port_factory, free_udp_port, free_udp_port_factory, integration_test_session, log_capture, mock_agent_factory, mock_config, mock_health_check_response, mock_llm_client, mock_vector_store, monkeypatch, no_cover, performance_test_config, pytestconfig, rate_limit_config, record_property, record_testsuite_property, record_xml_attribute, recwarn, security_test_data, session, test_anti_hallucination.py::<event_loop>, test_data, tmp_path, tmp_path_factory, tmpdir, tmpdir_factory, unused_tcp_port, unused_tcp_port_factory, unused_udp_port, unused_udp_port_factory
>       use 'pytest --fixtures [testpath]' for help on them.

/home/marcin/Dokumenty/agentai/makeit/AIASISSTMARUBO/test_anti_hallucination.py:14
=========================== short test summary info ============================
ERROR test_anti_hallucination.py::test_chat_endpoint
!!!!!!!!!!!!!!!!!!!!!!!!!! stopping after 1 failures !!!!!!!!!!!!!!!!!!!!!!!!!!!
======= 247 passed, 26 skipped, 45 warnings, 1 error in 65.01s (0:01:05) =======
